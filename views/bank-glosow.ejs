<%- include('partials/head') %>

<!-- HERO -->
<section class="py-12 md:py-16 border-b border-white/5">
  <div class="max-w-6xl mx-auto px-4 text-center">
    <h1 class="text-3xl md:text-4xl font-bold text-white mb-3" style="font-family: 'Poppins', sans-serif;">Bank g≈Ços√≥w</h1>
    <p class="text-lg text-gray-400 max-w-2xl mx-auto">Ponad 230 profesjonalnych lektor√≥w w 30+ jƒôzykach. Ods≈Çuchaj pr√≥bki i znajd≈∫ idealny g≈Ços.</p>
  </div>
</section>

<!-- FILTRY -->
<section class="py-6 bg-dark-800 sticky top-[73px] z-40 border-b border-white/5">
  <div class="max-w-6xl mx-auto px-4">
    <div class="flex flex-wrap items-center gap-3">
      <!-- P≈Çeƒá -->
      <div class="flex rounded-lg overflow-hidden border border-white/10">
        <button data-filter="gender" data-value="all" class="filter-btn active px-4 py-2 text-sm font-medium">Wszyscy</button>
        <button data-filter="gender" data-value="m" class="filter-btn px-4 py-2 text-sm font-medium">Mƒô≈ºczy≈∫ni</button>
        <button data-filter="gender" data-value="f" class="filter-btn px-4 py-2 text-sm font-medium">Kobiety</button>
      </div>

      <!-- Jƒôzyk -->
      <select id="filter-lang" class="bg-dark-700 border border-white/10 text-gray-300 text-sm rounded-lg px-4 py-2 focus:border-accent focus:outline-none">
        <option value="all">Wszystkie jƒôzyki</option>
        <option value="polski">Polski</option>
        <option value="angielski">Angielski</option>
        <option value="niemiecki">Niemiecki</option>
        <option value="rosyjski">Rosyjski</option>
        <option value="hiszpa≈Ñski">Hiszpa≈Ñski</option>
        <option value="francuski">Francuski</option>
        <option value="ukrai≈Ñski">Ukrai≈Ñski</option>
        <option value="portugalski">Portugalski</option>
        <option value="hebrajski">Hebrajski</option>
        <option value="w≈Çoski">W≈Çoski</option>
        <option value="czeski">Czeski</option>
        <option value="s≈Çowacki">S≈Çowacki</option>
        <option value="wƒôgierski">Wƒôgierski</option>
        <option value="holenderski">Holenderski</option>
        <option value="rumu≈Ñski">Rumu≈Ñski</option>
        <option value="turecki">Turecki</option>
        <option value="chi≈Ñski">Chi≈Ñski</option>
        <option value="japo≈Ñski">Japo≈Ñski</option>
        <option value="korea≈Ñski">Korea≈Ñski</option>
        <option value="arabski">Arabski</option>
        <option value="hindi">Hindi</option>
        <option value="szwedzki">Szwedzki</option>
        <option value="norweski">Norweski</option>
        <option value="du≈Ñski">Du≈Ñski</option>
        <option value="fi≈Ñski">Fi≈Ñski</option>
        <option value="grecki">Grecki</option>
        <option value="chorwacki">Chorwacki</option>
        <option value="serbski">Serbski</option>
        <option value="bu≈Çgarski">Bu≈Çgarski</option>
        <option value="litewski">Litewski</option>
        <option value="≈Çotewski">≈Åotewski</option>
      </select>

      <!-- Wiek -->
      <select id="filter-age" class="bg-dark-700 border border-white/10 text-gray-300 text-sm rounded-lg px-4 py-2 focus:border-accent focus:outline-none">
        <option value="all">Ka≈ºdy wiek</option>
        <option value="20-30">20-30 lat</option>
        <option value="30-50">30-50 lat</option>
        <option value="50+">50+ lat</option>
      </select>

      <!-- Zastosowanie -->
      <select id="filter-app" class="bg-dark-700 border border-white/10 text-gray-300 text-sm rounded-lg px-4 py-2 focus:border-accent focus:outline-none">
        <option value="all">Zastosowanie</option>
        <option value="Powitanie tel.">Powitanie tel.</option>
        <option value="Reklama">Reklama</option>
        <option value="Narracja do filmu">Narracja do filmu</option>
        <option value="Audiobook">Audiobook</option>
      </select>

      <!-- Specjalne -->
      <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white transition-colors">
        <input type="checkbox" id="filter-famous" class="w-4 h-4 rounded bg-dark-700 border-white/10 text-accent focus:ring-accent">
        Znani i lubiani
      </label>
      <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white transition-colors">
        <input type="checkbox" id="filter-native" class="w-4 h-4 rounded bg-dark-700 border-white/10 text-accent focus:ring-accent">
        Tylko natives
      </label>

      <!-- Szukaj -->
      <div class="ml-auto">
        <input type="text" id="filter-search" placeholder="Szukaj lektora..." class="bg-dark-700 border border-white/10 text-gray-300 text-sm rounded-lg px-4 py-2 w-48 focus:border-accent focus:outline-none placeholder-gray-500">
      </div>
    </div>
  </div>
</section>

<!-- LICZNIK -->
<div class="max-w-6xl mx-auto px-4 py-4">
  <p class="text-sm text-gray-500">Znaleziono: <span id="voice-count" class="text-white font-semibold"><%= voices.length %></span> lektor√≥w</p>
</div>

<!-- SIATKA LEKTOR√ìW -->
<section class="pb-16">
  <div class="max-w-6xl mx-auto px-4">
    <div id="voices-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-5">
      <% voices.forEach(function(v) { %>
      <div class="voice-card bg-dark-800 rounded-xl border border-white/5 overflow-hidden hover:border-accent/30 transition-all"
           data-gender="<%= v.gender %>"
           data-age="<%= v.age %>"
           data-languages="<%= v.languages.join(',') %>"
           data-famous="<%= v.famous %>"
           data-native="<%= v.native %>"
           data-apps="<%= v.applications ? v.applications.join(',') : '' %>"
           data-name="<%= v.name.toLowerCase() %>">

        <!-- G√≥rna czƒô≈õƒá: zdjƒôcie + info -->
        <div class="flex items-start gap-4 p-5 pb-3">
          <!-- Zdjƒôcie -->
          <div class="flex-shrink-0 w-20 h-20 rounded-xl overflow-hidden bg-dark-700">
            <% if (v.photo) { %>
              <img src="<%= v.photo %>" alt="<%= v.name %>" class="w-full h-full object-cover" loading="lazy">
            <% } else { %>
              <div class="w-full h-full flex items-center justify-center text-gray-600">
                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
              </div>
            <% } %>
          </div>

          <!-- Info -->
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between gap-2">
              <h3 class="text-lg font-bold text-white leading-tight truncate"><%= v.name %></h3>
              <% if (v.famous) { %>
                <span class="flex-shrink-0 text-[10px] bg-yellow-500/10 text-yellow-400 px-2 py-0.5 rounded font-medium whitespace-nowrap">‚≠ê Znany g≈Ços</span>
              <% } else if (v.native) { %>
                <span class="flex-shrink-0 text-[10px] bg-blue-500/10 text-blue-400 px-2 py-0.5 rounded font-medium whitespace-nowrap">üåç Native</span>
              <% } %>
            </div>
            <div class="flex items-center gap-1.5 mt-1 flex-wrap">
              <% if (v.age) { %>
                <span class="text-xs text-gray-500"><%= v.age %></span>
                <span class="text-xs text-gray-600">&bull;</span>
              <% } %>
              <% v.languages.forEach(function(lang) { %>
                <span class="text-[11px] bg-dark-600 text-gray-300 px-1.5 py-0.5 rounded"><%= lang %></span>
              <% }); %>
            </div>
            <% if (v.description) { %>
              <p class="text-xs text-gray-500 mt-1.5 line-clamp-2"><%= v.description %></p>
            <% } %>
          </div>
        </div>

        <!-- Audio player -->
        <div class="px-5 pb-4">
          <div class="flex items-center gap-3 bg-dark-900/50 rounded-lg p-3">
            <button class="play-btn w-10 h-10 flex-shrink-0 bg-accent hover:bg-accent-light rounded-full flex items-center justify-center transition-colors" data-audio="<%= v.audio %>">
              <svg class="play-icon w-5 h-5 text-white ml-0.5" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
              <svg class="pause-icon w-5 h-5 text-white hidden" fill="currentColor" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
            </button>
            <div class="flex-1">
              <div class="audio-progress w-full h-1.5 bg-dark-600 rounded-full overflow-hidden cursor-pointer">
                <div class="audio-bar h-full bg-accent rounded-full transition-all" style="width: 0%"></div>
              </div>
              <div class="flex justify-between mt-1">
                <span class="audio-time text-[10px] text-gray-500">0:00</span>
                <span class="audio-duration text-[10px] text-gray-500">--:--</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer: cena + link -->
        <div class="flex items-center justify-between px-5 pb-4">
          <div class="text-sm">
            <% if (v.turnaround) { %>
              <span class="text-gray-500">Realizacja: <%= v.turnaround %></span>
            <% } %>
          </div>
          <a href="<%= v.profileUrl %>" class="text-accent hover:text-accent-light text-sm font-medium transition-colors">
            Wiƒôcej &rarr;
          </a>
        </div>
      </div>
      <% }); %>
    </div>

    <!-- Pusty stan -->
    <div id="no-results" class="hidden text-center py-16">
      <svg class="w-16 h-16 text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/></svg>
      <p class="text-gray-500 text-lg">Nie znaleziono lektor√≥w spe≈ÇniajƒÖcych kryteria</p>
      <button onclick="resetFilters()" class="mt-4 text-accent hover:text-accent-light text-sm font-medium">Wyczy≈õƒá filtry</button>
    </div>
  </div>
</section>

<!-- CTA -->
<section class="py-12 bg-dark-800 border-t border-white/5">
  <div class="max-w-3xl mx-auto px-4 text-center">
    <h2 class="text-2xl font-bold text-white mb-3">Nie mo≈ºesz siƒô zdecydowaƒá?</h2>
    <p class="text-gray-400 mb-6">Opisz sw√≥j projekt, a pomo≈ºemy dobraƒá idealny g≈Ços.</p>
    <a href="/kontakt/" class="inline-block bg-accent hover:bg-accent-light text-white px-8 py-3 rounded-lg font-semibold transition-colors">Zapytaj o lektora</a>
  </div>
</section>

<script>
(function() {
  var currentAudio = null;
  var currentBtn = null;

  // Audio player
  document.querySelectorAll('.play-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var src = this.dataset.audio;
      var card = this.closest('.voice-card');
      var playIcon = this.querySelector('.play-icon');
      var pauseIcon = this.querySelector('.pause-icon');
      var bar = card.querySelector('.audio-bar');
      var timeEl = card.querySelector('.audio-time');
      var durEl = card.querySelector('.audio-duration');

      // Stop previous
      if (currentAudio && currentBtn !== this) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
        currentBtn.querySelector('.play-icon').classList.remove('hidden');
        currentBtn.querySelector('.pause-icon').classList.add('hidden');
        currentBtn.closest('.voice-card').querySelector('.audio-bar').style.width = '0%';
      }

      if (currentAudio && currentBtn === this && !currentAudio.paused) {
        currentAudio.pause();
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
        return;
      }

      if (!currentAudio || currentBtn !== this) {
        currentAudio = new Audio(src);
        currentBtn = this;

        currentAudio.addEventListener('loadedmetadata', function() {
          durEl.textContent = formatTime(currentAudio.duration);
        });

        currentAudio.addEventListener('timeupdate', function() {
          var pct = (currentAudio.currentTime / currentAudio.duration) * 100;
          bar.style.width = pct + '%';
          timeEl.textContent = formatTime(currentAudio.currentTime);
        });

        currentAudio.addEventListener('ended', function() {
          playIcon.classList.remove('hidden');
          pauseIcon.classList.add('hidden');
          bar.style.width = '0%';
          timeEl.textContent = '0:00';
        });

        // Click on progress bar
        card.querySelector('.audio-progress').addEventListener('click', function(e) {
          if (currentAudio && currentBtn === btn) {
            var rect = this.getBoundingClientRect();
            var pct = (e.clientX - rect.left) / rect.width;
            currentAudio.currentTime = pct * currentAudio.duration;
          }
        });
      }

      currentAudio.play();
      playIcon.classList.add('hidden');
      pauseIcon.classList.remove('hidden');
    });
  });

  function formatTime(s) {
    var m = Math.floor(s / 60);
    var sec = Math.floor(s % 60);
    return m + ':' + (sec < 10 ? '0' : '') + sec;
  }

  // Filters
  var activeGender = 'all';

  document.querySelectorAll('.filter-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      this.parentElement.querySelectorAll('.filter-btn').forEach(function(b) { b.classList.remove('active'); });
      this.classList.add('active');
      activeGender = this.dataset.value;
      applyFilters();
    });
  });

  document.getElementById('filter-lang').addEventListener('change', applyFilters);
  document.getElementById('filter-age').addEventListener('change', applyFilters);
  document.getElementById('filter-app').addEventListener('change', applyFilters);
  document.getElementById('filter-famous').addEventListener('change', applyFilters);
  document.getElementById('filter-native').addEventListener('change', applyFilters);
  document.getElementById('filter-search').addEventListener('input', applyFilters);

  function applyFilters() {
    var lang = document.getElementById('filter-lang').value;
    var age = document.getElementById('filter-age').value;
    var app = document.getElementById('filter-app').value;
    var famous = document.getElementById('filter-famous').checked;
    var native_ = document.getElementById('filter-native').checked;
    var search = document.getElementById('filter-search').value.toLowerCase();
    var count = 0;

    document.querySelectorAll('.voice-card').forEach(function(card) {
      var show = true;

      if (activeGender !== 'all' && card.dataset.gender !== activeGender) show = false;
      if (lang !== 'all' && card.dataset.languages.indexOf(lang) === -1) show = false;
      if (age !== 'all') {
        var cardAge = card.dataset.age;
        if (age === '50+') {
          if (cardAge !== '50 lat +' && cardAge !== '50+') show = false;
        } else if (age === '20-30') {
          if (cardAge !== '20-30 lat' && cardAge !== '20-30') show = false;
        } else if (age === '30-50') {
          if (cardAge !== '30-50 lat' && cardAge !== '30-50') show = false;
        }
      }
      if (app !== 'all' && card.dataset.apps.indexOf(app) === -1) show = false;
      if (famous && card.dataset.famous !== 'true') show = false;
      if (native_ && card.dataset.native !== 'true') show = false;
      if (search && card.dataset.name.indexOf(search) === -1) show = false;

      card.style.display = show ? '' : 'none';
      if (show) count++;
    });

    document.getElementById('voice-count').textContent = count;
    document.getElementById('no-results').classList.toggle('hidden', count > 0);
  }

  window.resetFilters = function() {
    activeGender = 'all';
    document.querySelectorAll('.filter-btn').forEach(function(b) { b.classList.remove('active'); });
    document.querySelector('.filter-btn[data-value="all"]').classList.add('active');
    document.getElementById('filter-lang').value = 'all';
    document.getElementById('filter-age').value = 'all';
    document.getElementById('filter-app').value = 'all';
    document.getElementById('filter-famous').checked = false;
    document.getElementById('filter-native').checked = false;
    document.getElementById('filter-search').value = '';
    applyFilters();
  };
})();
</script>

<style>
.filter-btn { color: #9ca3af; background: transparent; transition: all 0.2s; }
.filter-btn:hover { color: #fff; }
.filter-btn.active { color: #fff; background: #10b981; }
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
</style>

<%- include('partials/foot') %>
